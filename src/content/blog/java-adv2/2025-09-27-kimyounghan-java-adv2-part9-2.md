---
title: "네트워크 - 프로그램2"
pubDate: 2025-09-27
description: "김영한님의 자바 고급 2편 강의 part 9(네트워크 - 프로그램2) 학습 정리"
---

> **출처**: [김영한의 자바 고급 2편 강의](https://inf.run/8ES1C) - Section 9 : 네트워크 - 프로그램2

## 다중 클라이언트 관리

### 중앙 집중식 자원 관리

**모든 연결된 세션(소켓 및 스트림)을 중앙에서 관리**하고, 서버 종료 시 일괄적으로 자원 정리

## 네트워크 예외 처리

### 주요 예외들

| 예외                     | 발생 원인              | 예시                              |
| ------------------------ | ---------------------- | --------------------------------- |
| **UnknownHostException** | IP 주소를 찾을 수 없음 | 잘못된 호스트 이름                |
| **Connection Refused**   | 서버가 연결 거절       | 서버 종료, 방화벽 차단, 포트 없음 |

## 타임아웃 설정

### 연결 타임아웃 vs 소켓 타임아웃

| 타입              | 의미                       | 설정 방법                |
| ----------------- | -------------------------- | ------------------------ |
| **연결 타임아웃** | TCP 연결 수립 최대 시간    | `connect(addr, timeout)` |
| **소켓 타임아웃** | 데이터 읽기 대기 최대 시간 | `setSoTimeout(millis)`   |

### 권장 설정

```java
Socket socket = new Socket();
socket.connect(new InetSocketAddress("host", 8080), 5000);  // 연결 타임아웃 5초
socket.setSoTimeout(3000);  // 소켓 타임아웃 3초
```

**외부 서버 통신 시 반드시 설정 권장**

## TCP 연결 종료

### 정상 종료

```java
// 서버에서 먼저 종료
socket.close();  // FIN 패킷 전송

// 클라이언트에서 확인
int data = inputStream.read();
if (data == -1) {  // EOF 신호
    socket.close();  // 클라이언트도 종료
}
```

**과정**: FIN 패킷 교환 → 양방향 정상 종료

### 강제 종료

**RST 패킷** 발생 시 즉시 연결 종료

**발생 상황**:

- 상대방 FIN 이후 데이터 전송
- 닫힌 소켓에 쓰기 시도
- TCP/IP 프로토콜 규칙 위반

## 예외 처리 전략

### 통합 처리 방식

```java
try {
    // 네트워크 작업
} catch (IOException e) {
    // 자원 정리
    socket.close();

    // 필요시 예외 구분 처리
    if (e instanceof SocketException) {
        // 소켓 관련 처리
    }
}
```

**전략**:

- **모든 네트워크 예외를 IOException으로 통합 처리**
- **자원 정리 후 필요시 세부 예외 구분**
- **정상/강제 종료 모두 자원 정리 보장**
